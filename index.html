<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE HIDDEN ONES | ANIMUS 2.0</title>
    <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Assassins_Creed_Logo.svg/2500px-Assassins_Creed_Logo.svg.png">
    <style>
        :root { --cyan: #00ffcc; --gold: #ffcc00; --bg: #020508; --red: #ff3333; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: var(--cyan); font-family: 'Courier New', monospace; overflow: hidden; height: 100%; width: 100%; touch-action: none; }
        
        #white-out { position: fixed; inset: 0; background: white; z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.5s; }
        #star-canvas { position: fixed; inset: 0; z-index: 1; cursor: crosshair; }
        #sync-ui { position: fixed; bottom: 12%; width: 100%; text-align: center; z-index: 5; letter-spacing: 3px; font-size: 10px; animation: blink 2s infinite; pointer-events: none; padding: 0 10px; box-sizing: border-box; }
        @keyframes blink { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }

        #terminal-ui { position: relative; z-index: 10; display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; width: 100%; padding: 20px; box-sizing: border-box; }
        .terminal-box { background: rgba(0, 10, 15, 0.9); border: 1px solid rgba(0, 255, 204, 0.2); padding: 20px; width: 100%; max-width: 800px; backdrop-filter: blur(10px); box-shadow: 0 0 50px #000; }
        .header { font-size: 0.8rem; letter-spacing: 5px; margin-bottom: 15px; border-bottom: 1px solid rgba(0, 255, 204, 0.1); padding-bottom: 10px; text-align: center; color: #fff; }
        .data-stream { font-size: 0.8rem; line-height: 1.6; height: 280px; overflow-y: auto; margin-bottom: 20px; scrollbar-width: none; }
        .data-stream::-webkit-scrollbar { display: none; }
        
        input { background: rgba(255,255,255,0.05); border: none; border-bottom: 1px solid var(--cyan); color: inherit; padding: 12px; width: 100%; outline: none; font-family: inherit; text-align: center; box-sizing: border-box; font-size: 16px; /* Prevents auto-zoom on iOS */ }
        .btn { background: transparent; border: 1px solid var(--cyan); color: inherit; padding: 8px 12px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; margin: 4px; font-family: inherit; font-size: 0.65rem; transition: 0.3s; display: inline-block; }
        .btn:hover { background: var(--cyan); color: #000; }

        body.breach-mode { background: #200; color: var(--red); }
        body.initiation-mode { background: #f5f5f5; color: #222; }
        body.initiation-mode .terminal-box { background: white; border-color: var(--gold); }

        #fail-overlay { position: fixed; inset: 0; background: rgba(100,0,0,0.8); z-index: 10000; display: none; justify-content: center; align-items: center; font-size: 1.5rem; font-weight: bold; letter-spacing: 5px; color: white; }
        #video-container { position: fixed; inset: 0; background: #000; z-index: 2000; display: none; }
        video { width: 100%; height: 100%; object-fit: contain; }

        @media (min-width: 600px) {
            .header { font-size: 1rem; letter-spacing: 10px; }
            .data-stream { font-size: 0.85rem; height: 320px; }
            .btn { font-size: 0.7rem; padding: 10px 18px; }
            #sync-ui { font-size: 12px; letter-spacing: 5px; }
        }
    </style>
</head>
<body id="body">

    <div id="white-out"></div>
    <div id="fail-overlay">DESYNCHRONIZED</div>
    <canvas id="star-canvas"></canvas>
    <div id="sync-ui">HOLD TO ALIGN NEURAL NETWORK</div>

    <div id="video-container">
        <video id="memory-video" playsinline><source src="videoplayback.mp4" type="video/mp4"></video>
    </div>

    <div id="terminal-ui">
        <div class="terminal-box">
            <div class="header" id="term-header">ANIMUS // MASTER_CORE</div>
            <div class="data-stream" id="stream"></div>
            <div id="input-area"><input type="text" id="passInput" placeholder="ENTER OATH" autocomplete="off" inputmode="text"></div>
            <div id="action-buttons" style="display:none; margin-top:15px; text-align: center;">
                <button class="btn" onclick="triggerTruth()">THE TRUTH</button>
                <button class="btn" onclick="showLore('altair')">ALTAÏR</button>
                <button class="btn" onclick="showLore('ezio')">EZIO</button>
                <button class="btn" onclick="showLore('nexus')">CONNECTION</button>
                <button class="btn" onclick="showLore('library')">LIBRARY</button>
                <button class="btn" onclick="location.reload()">REBOOT</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('star-canvas');
        const ctx = canvas.getContext('2d');
        const stream = document.getElementById('stream');
        const video = document.getElementById('memory-video');
        let width, height, stars = [], audioCtx, syncProgress = 0, synced = false;
        
        const insignia = [{x:0, y:-0.8},{x:0.4, y:0.2},{x:0.3, y:0.2},{x:0, y:-0.3},{x:-0.3, y:0.2},{x:-0.4, y:0.2}];

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            stars = Array.from({length: 300}, () => ({
                x: Math.random() * width, y: Math.random() * height,
                vx: (Math.random()-0.5)*0.5, vy: (Math.random()-0.5)*0.5,
                target: insignia[Math.floor(Math.random()*insignia.length)]
            }));
        }

        let mouse = {x: width/2, y: height/2, down: false};

        function handleStart(e) {
            mouse.down = true;
            if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const pos = e.touches ? e.touches[0] : e;
            mouse.x = pos.clientX;
            mouse.y = pos.clientY;
        }
        function handleMove(e) {
            const pos = e.touches ? e.touches[0] : e;
            mouse.x = pos.clientX;
            mouse.y = pos.clientY;
        }
        function handleEnd() { mouse.down = false; }

        window.addEventListener('mousedown', handleStart);
        window.addEventListener('touchstart', handleStart, {passive: false});
        window.addEventListener('mousemove', handleMove);
        window.addEventListener('touchmove', (e) => { e.preventDefault(); handleMove(e); }, {passive: false});
        window.addEventListener('mouseup', handleEnd);
        window.addEventListener('touchend', handleEnd);
        window.addEventListener('resize', init);

        function playSound(f, v=0.05) {
            if(!audioCtx) return;
            let o = audioCtx.createOscillator(), g = audioCtx.createGain();
            o.frequency.value = f; g.gain.value = v;
            let filt = audioCtx.createBiquadFilter(); filt.type = "lowpass"; filt.frequency.value = 400;
            o.connect(filt); filt.connect(g); g.connect(audioCtx.destination);
            o.start(); o.stop(audioCtx.currentTime+0.1);
        }

        function loop() {
            ctx.fillStyle = 'rgba(2,5,8,0.2)';
            ctx.fillRect(0,0,width,height);
            if(synced) return;

            if(mouse.down) {
                syncProgress = Math.min(1, syncProgress + 0.008);
                if(syncProgress >= 1) performLeap();
            } else {
                syncProgress = Math.max(0, syncProgress - 0.015);
            }

            let scale = Math.min(width, height) * 0.35;

            stars.forEach(s => {
                if(mouse.down) {
                    let tx = mouse.x + s.target.x * scale;
                    let ty = (mouse.y - 20) + s.target.y * (scale * 1.3);
                    s.x += (tx - s.x) * 0.12; s.y += (ty - s.y) * 0.12;
                } else {
                    s.x += s.vx; s.y += s.vy;
                    if(s.x<0||s.x>width) s.vx*=-1; if(s.y<0||s.y>height) s.vy*=-1;
                }
                ctx.fillStyle = `rgba(0, 255, 204, ${0.4 + syncProgress})`;
                ctx.fillRect(s.x, s.y, 1.5, 1.5);
            });
            requestAnimationFrame(loop);
        }

        function performLeap() {
            synced = true;
            document.getElementById('white-out').style.opacity = '1';
            playSound(80, 0.2);
            setTimeout(() => {
                document.getElementById('star-canvas').style.display = 'none';
                document.getElementById('sync-ui').style.display = 'none';
                document.getElementById('terminal-ui').style.display = 'flex';
                document.getElementById('white-out').style.opacity = '0';
                typeText("> SYNCHRONIZATION COMPLETE\n> OATH REQUIRED...");
            }, 600);
        }

        async function typeText(t) {
            stream.innerHTML = "";
            const lines = t.split('\n');
            for(let line of lines) {
                let div = document.createElement('div');
                div.style.marginBottom = "10px";
                stream.appendChild(div);
                for(let char of line) {
                    div.innerHTML += char;
                    if(char !== ' ') playSound(60 + Math.random()*40);
                    await new Promise(r => setTimeout(r, 15));
                    stream.scrollTop = stream.scrollHeight;
                }
            }
        }

        document.getElementById('passInput').addEventListener('keypress', e => {
            if(e.key === 'Enter') {
                let v = e.target.value.toLowerCase().trim();
                e.target.value = "";
                if(v === "nothing is true everything is permitted") {
                    document.getElementById('input-area').style.display = 'none';
                    document.getElementById('action-buttons').style.display = 'block';
                    typeText("> ACCESS GRANTED.\n> WELCOME, MENTOR.");
                } else if(v === "abstergo") {
                    document.body.className = "breach-mode";
                    typeText("!! BREACH DETECTED !!");
                } else if(v === "recruit") {
                    document.body.className = "initiation-mode";
                    typeText("> RIDDLE: I have no voice, but I speak of the past. What am I?");
                } else if(v === "history" || v === "truth") {
                    typeText("> CORRECT. THE BROTHERHOOD AWAITS.");
                } else {
                    document.getElementById('fail-overlay').style.display = 'flex';
                    setTimeout(() => document.getElementById('fail-overlay').style.display='none', 1000);
                }
            }
        });

        function showLore(h) {
            const data = {
                altair: "> ALTAÏR IBN-LA'AHAD: Master Assassin of the Levantine Brotherhood. He transformed the Order from public executioners into secret shadows.",
                ezio: "> EZIO AUDITORE: The Renaissance Master. As the Prophet, he bridged the past and future, ensuring the message reached Desmond.",
                nexus: "> THE CONNECTION: Separated by centuries, Altaïr and Ezio are linked by fate as messengers for a future they would never see.",
                library: "> THE LIBRARY: A vault for Altaïr's knowledge and the Apple of Eden. It served as a bridge through time where Ezio abandoned his weapons."
            };
            typeText(data[h]);
        }

        function triggerTruth() {
            document.getElementById('video-container').style.display = 'block';
            video.play();
        }

        video.onended = () => { window.location.href = "https://assassinscreed.fandom.com/wiki/The_Truth"; };

        init(); loop();
    </script>
</body>
</html>